# 小红书产品种草笔记功能开发文档

## 📋 项目概述

本文档记录了为"秒懂AI超级写作员工"项目开发小红书产品种草笔记功能的完整过程，包括需求分析、技术实现和部署说明。

**开发时间：** 2026-01-29
**功能模块：** 小红书产品种草笔记表单收集与AI生成
**模板ID：** 107

---

## 🎯 需求分析

### 功能需求

根据系统提示词（小红书爆款种草文案生成专家 v2.0），需要实现一个专门的表单页面，用于收集用户的产品信息，并通过AI生成符合小红书风格的产品种草笔记文案。

### 系统提示词要求

系统提示词定义了AI助手的角色和工作流程：

**角色定位：**
- 小红书爆款种草文案生成专家
- 专属小红书爆款文案创作伙伴
- 让每个产品都能成为爆款

**核心目标：**
1. 爆款转化：将产品信息转化为符合小红书算法和用户喜好的高质量内容
2. 情感共鸣：创作真实、有温度、能触动用户痛点的种草文案
3. 流量优化：提供高点击率标题和互动引导，提升笔记曝光和转化
4. 效率提升：快速生成多版本文案，节省用户创作时间
5. 持续优化：根据反馈不断迭代，直到用户满意为止

**需要收集的信息：**
1. 📦 产品信息：名称、品类、品牌、价格区间
2. ⭐ 核心卖点：最多3个优势
3. 👥 目标人群：学生党/上班族/宝妈等
4. 🎯 使用场景：什么时候用、解决什么问题
5. 💡 特殊要求：强调重点、风格偏好（可选）

**重要特性：**
- 所有表单字段都是可选的，用户根据需求填选
- 提供继续提问的表单位置，支持迭代优化

---

## 🏗️ 技术架构

### 前端技术栈

- **框架：** Next.js 16.0.10 (App Router)
- **UI组件：** shadcn/ui
- **语言：** TypeScript
- **样式：** Tailwind CSS

### 后端技术栈

- **API框架：** Next.js API Routes
- **AI服务：** DeepSeek API
- **环境变量管理：** .env.local

### 文件结构

```
components/
  └── xiaohongshu-writing-page.tsx    # 主页面组件
app/
  └── api/
      └── product-review/
          └── route.ts                 # API路由
docs/
  └── 小红书产品种草笔记功能开发文档.md  # 本文档
.env.local                             # 环境变量配置
```

---

## 💻 实现过程

### 第一阶段：表单设计与状态管理

#### 1. 添加表单状态变量

在 `xiaohongshu-writing-page.tsx` 中添加产品种草笔记专用的状态：

```typescript
// 产品种草笔记专用表单状态
const [productName, setProductName] = useState(""); // 产品名称
const [productCategory, setProductCategory] = useState(""); // 产品品类
const [productBrand, setProductBrand] = useState(""); // 品牌
const [productPrice, setProductPrice] = useState(""); // 价格区间
const [productFeatures, setProductFeatures] = useState(""); // 核心卖点
const [productAudience, setProductAudience] = useState(""); // 目标人群
const [productScene, setProductScene] = useState(""); // 使用场景
const [productRequirements, setProductRequirements] = useState(""); // 特殊要求（可选）
```

#### 2. 实现表单UI

根据模板ID（107）条件渲染专用表单：

```typescript
{templateId === "107" ? (
  <>
    {/* 产品名称 */}
    <Input
      placeholder="例如：戴森吹风机、雅诗兰黛小棕瓶、iPhone 15 Pro..."
      value={productName}
      onChange={(e) => setProductName(e.target.value)}
    />

    {/* 产品品类 */}
    <Input
      placeholder="例如：美妆护肤、数码家电、生活好物、食品饮料..."
      value={productCategory}
      onChange={(e) => setProductCategory(e.target.value)}
    />

    {/* 品牌 */}
    <Input
      placeholder="例如：戴森、雅诗兰黛、苹果、无印良品..."
      value={productBrand}
      onChange={(e) => setProductBrand(e.target.value)}
    />

    {/* 价格区间 */}
    <Input
      placeholder="例如：99元、300-500元、千元以内..."
      value={productPrice}
      onChange={(e) => setProductPrice(e.target.value)}
    />

    {/* 核心卖点 */}
    <Textarea
      placeholder="请列出产品最牛的3个优势..."
      value={productFeatures}
      onChange={(e) => setProductFeatures(e.target.value)}
    />

    {/* 目标人群 */}
    <Input
      placeholder="例如：学生党、上班族、宝妈、精致女孩..."
      value={productAudience}
      onChange={(e) => setProductAudience(e.target.value)}
    />

    {/* 使用场景 */}
    <Textarea
      placeholder="什么时候用？解决什么问题？"
      value={productScene}
      onChange={(e) => setProductScene(e.target.value)}
    />

    {/* 特殊要求（可选） */}
    <Textarea
      placeholder="有没有特别想强调的点？喜欢什么风格？"
      value={productRequirements}
      onChange={(e) => setProductRequirements(e.target.value)}
    />

    {/* 继续提问提示 */}
    <div className="bg-blue-50 dark:bg-blue-950/20 rounded-lg p-4">
      <p className="text-sm text-blue-700 dark:text-blue-300">
        💬 <strong>提示：</strong>生成文案后，你可以在下方继续提问...
      </p>
    </div>
  </>
) : (
  // 其他模板的通用表单
  ...
)}
```

### 第二阶段：表单验证与数据处理

#### 1. 添加表单验证逻辑

```typescript
if (templateId === "107") {
  // 产品种草笔记表单验证（所有字段都是可选的，用户根据需求填选）
  // 不进行必填验证，但至少需要有一些基本信息
  if (!productName.trim() && !productCategory.trim() && !productFeatures.trim()) {
    setError("请至少填写产品名称、品类或核心卖点中的一项");
    return;
  }
}
```

#### 2. 格式化表单数据

将表单数据组合成结构化的描述文本：

```typescript
const productInfo = `📦 产品信息：${productName ? `${productName}` : ""}${productCategory ? ` | 品类：${productCategory}` : ""}${productBrand ? ` | 品牌：${productBrand}` : ""}${productPrice ? ` | 价格：${productPrice}` : ""}

⭐ 核心卖点：${productFeatures || "待补充"}

👥 目标人群：${productAudience || "待补充"}

🎯 使用场景：${productScene || "待补充"}
${productRequirements ? `\n💡 特殊要求：${productRequirements}` : ""}`;
```

### 第三阶段：API集成

#### 1. 创建专用API端点

创建 `/api/product-review` 端点，使用完整的系统提示词：

```typescript
// app/api/product-review/route.ts
const SYSTEM_PROMPT = `# 小红书爆款种草文案生成专家 🌟

## Profile
- **author**: 呱呱
- **version**: 2.0
- **language**: 中文
- **wxid**: pluto2596
- **description**: 你的专属小红书爆款文案创作伙伴，让每个产品都能成为爆款

## Background
在小红书这个"种草天堂"，每天有数百万用户在寻找值得买的好物。用户需要一个能快速将产品信息转化为高质量种草笔记的工具——不仅要写得真实接地气，还要懂平台规则、抓用户眼球、引发情感共鸣。

## Goals
1. **爆款转化**：将产品信息转化为符合小红书算法和用户喜好的高质量内容
2. **情感共鸣**：创作真实、有温度、能触动用户痛点的种草文案
3. **流量优化**：提供高点击率标题和互动引导，提升笔记曝光和转化
4. **效率提升**：快速生成多版本文案，节省用户创作时间
5. **持续优化**：根据反馈不断迭代，直到用户满意为止

## Constrains
1. **标题规范**：20字以内，必含1-3个emoji，至少1个#话题标签
2. **字数控制**：正文300-500字，移动端3-5屏最佳阅读体验
3. **语言风格**：必须口语化、生活化、接地气，像闺蜜聊天
4. **真实性原则**：禁止虚假夸大，所有描述基于产品真实特点
5. **反广告感**：避免硬推销话术，保持自然分享感
6. **场景化要求**：必须包含具体使用场景和真实体验细节
7. **emoji使用**：适度点缀增强表现力，避免过度堆砌影响阅读
8. **平台合规**：遵守小红书社区规范，避免违规词汇

## Skills
1. **爆款标题公式掌握**
2. **场景化叙事能力**
3. **情绪价值传递**
4. **卖点黄金提炼**
5. **结构化内容设计**
6. **互动转化技巧**

## Rules
1. **内容真实性**：所有文案必须基于用户提供的真实产品信息，严禁编造虚假功效
2. **标题强制要求**：必须包含emoji表情+话题标签，总字数≤20字
3. **开头3秒法则**：前50字必须击中痛点或制造共鸣，抓住用户注意力
4. **数据具体化**：避免"很好""非常"等模糊词，用"提升30%""节省2小时"等量化表达
5. **场景必备元素**：每篇文案至少包含1个具体使用场景+真实使用感受+效果对比
6. **分段易读性**：每段2-3行，多用短句、断句，方便手机端阅读
7. **结尾互动化**：必须包含提问、征集或行动引导,提升互动率
8. **语气一致性**：全文保持轻松友好的"姐妹分享"语气,避免说教感
9. **emoji适度原则**：正文每段最多2个emoji,避免影响阅读流畅度
10. **多版本输出**：默认提供3个不同风格的标题供选择

## Workflow
1. **信息收集阶段**
2. **策略分析阶段**
3. **文案创作阶段**
4. **呈现与优化阶段**
5. **延伸建议阶段**
`;

export async function POST(request: NextRequest) {
  // API实现逻辑
}
```

#### 2. 修改API调用逻辑

```typescript
if (templateId === "107") {
  apiEndpoint = "/api/product-review";
  requestBody = { content: productInfo };
}
```

### 第四阶段：UI优化

#### 1. 自定义欢迎文本

```typescript
{templateId === "107"
  ? "🌟 嗨呀！我是你的小红书爆款文案搭子！把产品变成让人忍不住点赞收藏的种草笔记！无论是美妆护肤、数码家电还是生活好物，我都能写出让人心动下单的文案～准备好一起整个爆款出来了吗？🚀"
  : `欢迎来到${templateTitle}创作空间！...`
}
```

#### 2. 历史记录格式优化

```typescript
const contentForHistory = templateId === "107"
  ? `${productName || productCategory} | ${productAudience || "通用"} | ${productScene || "日常使用"}`
  : contentInput;
```

#### 3. 继续提问提示

在表单底部添加了一个醒目的提示框，引导用户在生成文案后可以继续提问优化：

```typescript
<div className="bg-blue-50 dark:bg-blue-950/20 rounded-lg p-4 border border-blue-200 dark:border-blue-800">
  <p className="text-sm text-blue-700 dark:text-blue-300 leading-relaxed">
    💬 <strong>提示：</strong>生成文案后，你可以在下方继续提问，比如：
    <br />• "能不能再强调一下性价比？"
    <br />• "标题能不能更吸引人一点？"
    <br />• "能不能换个风格，更活泼一些？"
  </p>
</div>
```

---

## 📦 环境配置

### .env.local 配置

```bash
# DeepSeek API 配置
DEEPSEEK_API_KEY=your_api_key_here
DEEPSEEK_API_URL=https://api.deepseek.com/v1/chat/completions

# 历史记录存储方式
# 本地测试：false 或不设置（使用 localStorage）
# 生产环境：true（使用数据库）
NEXT_PUBLIC_USE_DATABASE=false
```

---

## 🚀 部署与测试

### 本地开发

```bash
# 安装依赖
npm install

# 启动开发服务器
npm run dev

# 访问地址
http://localhost:3000/writing/xiaohongshu?template=107&title=小红书产品种草笔记&source=media-xiaohongshu
```

### 构建生产版本

```bash
# 构建项目
npm run build

# 启动生产服务器
npm start
```

### 测试步骤

1. **访问页面**
   - 导航到小红书产品种草笔记页面

2. **填写表单**（所有字段可选，根据需求填写）
   - 产品名称：戴森吹风机
   - 产品品类：数码家电
   - 品牌：戴森
   - 价格区间：2000-3000元
   - 核心卖点：超强吸力、智能温控、静音设计
   - 目标人群：精致女孩、上班族
   - 使用场景：早晨赶时间、约会前造型
   - 特殊要求：强调性价比和使用体验

3. **提交生成**
   - 点击"智能创作"按钮
   - 等待AI生成结果（约10-20秒）

4. **验证结果**
   - 检查生成的文案是否符合小红书风格
   - 验证是否包含3个不同风格的标题
   - 确认正文是否包含场景化描述和互动引导
   - 确认历史记录是否正确保存

5. **继续提问测试**
   - 在生成结果后，尝试继续提问优化
   - 例如："能不能再强调一下性价比？"
   - 验证AI是否能基于之前的内容进行优化

---

## 🎨 UI设计说明

### 表单布局

- **布局方式：** 垂直堆叠，单列布局
- **间距：** 使用 `space-y-4` 统一间距
- **标签样式：** 所有字段都是可选的，不显示红色星号
- **输入框：** 使用 shadcn/ui 的 Input 和 Textarea 组件
- **提示文本：** 使用 placeholder 提供详细的输入示例

### 视觉风格

- **主色调：** 保持与整体应用一致
- **表单元素：** 圆角、边框、阴影效果
- **提示框：** 蓝色背景，清晰的提示信息
- **错误提示：** 红色背景，清晰的错误信息
- **加载状态：** 旋转图标 + 提示文本

### 响应式设计

- **桌面端：** 60%表单区 + 40%结果区
- **移动端：** 全宽布局，结果区下移

---

## 📊 性能优化

### 前端优化

1. **状态管理：** 使用 React Hooks 管理表单状态
2. **条件渲染：** 根据模板ID按需渲染组件
3. **错误边界：** 完善的错误处理和用户提示

### 后端优化

1. **超时控制：** API请求设置合理超时
2. **错误处理：** 完整的try-catch错误捕获
3. **响应格式：** 统一的JSON响应格式

---

## 🔒 安全考虑

### API密钥管理

- ✅ 使用环境变量存储API密钥
- ✅ .env.local 文件不提交到Git仓库
- ✅ 生产环境使用独立的API密钥

### 输入验证

- ✅ 前端表单验证
- ✅ 后端参数验证
- ✅ 防止SQL注入和XSS攻击

### 错误处理

- ✅ 不暴露敏感的错误信息
- ✅ 记录详细的服务器日志
- ✅ 用户友好的错误提示

---

## 📚 相关文档

### 系统提示词

完整的系统提示词定义了AI助手的角色、技能、规则和工作流程，存储在：
- `app/api/product-review/route.ts` 的 `SYSTEM_PROMPT` 常量中

### API文档

- **端点：** `/api/product-review`
- **方法：** POST
- **请求体：**
  ```json
  {
    "content": "📦 产品信息：戴森吹风机 | 品类：数码家电 | 品牌：戴森 | 价格：2000-3000元\n\n⭐ 核心卖点：超强吸力、智能温控、静音设计\n\n👥 目标人群：精致女孩、上班族\n\n🎯 使用场景：早晨赶时间、约会前造型\n\n💡 特殊要求：强调性价比和使用体验"
  }
  ```
- **响应体：**
  ```json
  {
    "success": true,
    "result": "生成的文案内容...",
    "usage": {
      "prompt_tokens": 100,
      "completion_tokens": 500,
      "total_tokens": 600
    }
  }
  ```

---

## 🎯 功能特点

### 1. 灵活的表单设计

- **所有字段可选：** 用户可以根据实际情况选择填写哪些字段
- **智能验证：** 只要求至少填写产品名称、品类或核心卖点中的一项
- **详细提示：** 每个字段都有清晰的placeholder示例

### 2. 继续提问支持

- **醒目提示：** 在表单底部提供继续提问的引导
- **示例问题：** 给出具体的提问示例，降低用户使用门槛
- **迭代优化：** 支持用户在生成结果后继续优化文案

### 3. 用户体验优化

- **清晰的标签：** 使用emoji图标增强视觉识别
- **合理的布局：** 表单字段按逻辑顺序排列
- **友好的提示：** 提供详细的输入示例和使用说明

---

## 🎯 未来优化方向

### 功能增强

1. **图片上传：** 支持用户上传产品图片
2. **模板选择：** 提供多种文案风格模板
3. **批量生成：** 一次生成多个版本供选择
4. **对比功能：** 支持多个产品的对比种草

### 用户体验

1. **实时预览：** 边填写边预览效果
2. **智能推荐：** 根据产品类型推荐卖点和场景
3. **历史记录：** 更强大的历史记录管理
4. **分享功能：** 一键分享到小红书

### 技术优化

1. **缓存机制：** 缓存常见产品的生成结果
2. **流式输出：** 使用SSE实现实时生成
3. **并发控制：** 限制同时生成的请求数量
4. **监控告警：** 添加性能监控和错误告警

---

## 👥 开发团队

- **开发者：** Claude Sonnet 4.5
- **项目负责人：** [用户名]
- **开发时间：** 2026-01-29

---

## 📄 许可证

本项目遵循项目整体的许可证协议。

---

## 🙏 致谢

感谢以下技术和服务的支持：
- Next.js 团队
- shadcn/ui 组件库
- DeepSeek AI 服务
- Vercel 部署平台

---

**文档版本：** 1.0
**最后更新：** 2026-01-29
**维护者：** 开发团队

# å¯¹è¯å¼UIæ¨¡å—å¼€å‘æµç¨‹æ ‡å‡†

## ğŸ“‹ æ–‡æ¡£è¯´æ˜

æœ¬æ–‡æ¡£æä¾›äº†å¯¹è¯å¼UIæ¨¡å—çš„æ ‡å‡†å¼€å‘æµç¨‹ï¼Œé€‚ç”¨äºæ‰€æœ‰éœ€è¦å®ç°å¯¹è¯å¼äº¤äº’ç•Œé¢çš„åŠŸèƒ½æ¨¡å—ã€‚

**åˆ›å»ºæ—¶é—´ï¼š** 2026-02-11
**é€‚ç”¨èŒƒå›´ï¼š** å°çº¢ä¹¦ã€æ²Ÿé€šåä½œã€æ±‡æŠ¥æ€»ç»“ç­‰æ‰€æœ‰å¯¹è¯å¼UIæ¨¡å—
**å‚è€ƒæ¡ˆä¾‹ï¼š** å°çº¢ä¹¦æ¨¡å—ã€ä¼šè®®é‚€è¯·å‡½æ¨¡å—

---

## ğŸ¯ å¯¹è¯å¼UIç‰¹ç‚¹

### æ ¸å¿ƒä¼˜åŠ¿
- âœ… æ¸è¿›å¼å¼•å¯¼ï¼Œé™ä½ç”¨æˆ·è®¤çŸ¥è´Ÿæ‹…
- âœ… å¤šè½®å¯¹è¯ï¼Œæ”¯æŒè¿­ä»£ä¼˜åŒ–
- âœ… å®æ—¶åé¦ˆï¼Œæå‡äº¤äº’ä½“éªŒ
- âœ… å†å²è®°å½•ï¼Œæ–¹ä¾¿å›æº¯å’Œå¤ç”¨

### é€‚ç”¨åœºæ™¯
- éœ€è¦æ”¶é›†å¤šä¸ªä¿¡æ¯ç‚¹çš„å¤æ‚è¡¨å•
- éœ€è¦AIè¾…åŠ©åˆ›ä½œçš„å†…å®¹ç”Ÿæˆ
- éœ€è¦å¤šè½®äº¤äº’ä¼˜åŒ–çš„åœºæ™¯
- éœ€è¦ä¿å­˜å¯¹è¯å†å²çš„åœºæ™¯

---

## ğŸ—ï¸ æ ‡å‡†æ¶æ„è®¾è®¡

### é¡µé¢å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è¿”å›  [æ¨¡å—åç§°]    æ–°å»ºå¯¹è¯  å†å²è®°å½•    æ–‡æœ¬ç¼–è¾‘å™¨  å¤åˆ¶  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                              â”‚                              â”‚
â”‚  å¯¹è¯æ¶ˆæ¯åŒºåŸŸ (50%)          â”‚  å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ (50%)          â”‚
â”‚                              â”‚                              â”‚
â”‚  - AIæ¬¢è¿æ¶ˆæ¯                â”‚  - æ˜¾ç¤ºç”Ÿæˆç»“æœ              â”‚
â”‚  - ç”¨æˆ·è¾“å…¥æ¶ˆæ¯              â”‚  - æ”¯æŒå®æ—¶ç¼–è¾‘              â”‚
â”‚  - AIå›å¤æ¶ˆæ¯                â”‚  - æ ¼å¼åŒ–æ˜¾ç¤º                â”‚
â”‚  - åŠ è½½çŠ¶æ€                  â”‚                              â”‚
â”‚                              â”‚                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                              â”‚
â”‚  è¾“å…¥æ¡† (è‡ªé€‚åº”é«˜åº¦)    å‘é€  â”‚                              â”‚
â”‚  å¯¹è¯è½®æ¬¡: 0/5               â”‚                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŠ€æœ¯æ ˆ
- **æ¡†æ¶ï¼š** Next.js 14 (App Router)
- **UIåº“ï¼š** React 18 + TypeScript
- **ç»„ä»¶åº“ï¼š** shadcn/ui
- **æ ·å¼ï¼š** Tailwind CSS
- **çŠ¶æ€ç®¡ç†ï¼š** React Hooks
- **æ•°æ®åº“ï¼š** Supabase (å†å²è®°å½•)

---

## ğŸ“ å¼€å‘æµç¨‹ï¼ˆ5æ­¥æ³•ï¼‰

### ç¬¬ä¸€æ­¥ï¼šåˆ†æå‚è€ƒæ¨¡æ¿

**ç›®æ ‡ï¼š** äº†è§£ç°æœ‰å¯¹è¯å¼ç•Œé¢çš„å®ç°é€»è¾‘

**æ“ä½œï¼š**
```bash
# è¯»å–å‚è€ƒç»„ä»¶
Read components/xiaohongshu-writing-page.tsx
# æˆ–
Read components/communication-writing-page.tsx
```

**å…³é”®è¦ç‚¹ï¼š**
- å·¦å³50/50åˆ†æ å¸ƒå±€
- å·¦ä¾§ï¼šå¯¹è¯æ¶ˆæ¯åŒºåŸŸ + åº•éƒ¨è¾“å…¥æ¡†
- å³ä¾§ï¼šå¯Œæ–‡æœ¬ç¼–è¾‘å™¨ / å†å²è®°å½•åˆ‡æ¢
- æ”¯æŒå¤šè½®å¯¹è¯ï¼Œæœ€å¤š5è½®
- ä½¿ç”¨MessageBubbleç»„ä»¶æ˜¾ç¤ºæ¶ˆæ¯
- è¾“å…¥æ¡†é«˜åº¦è‡ªé€‚åº”ï¼ˆ60px-150pxï¼‰

---

### ç¬¬äºŒæ­¥ï¼šåˆ›å»ºæ–°ç»„ä»¶

**ç›®æ ‡ï¼š** åŸºäºå‚è€ƒæ¨¡æ¿åˆ›å»ºæ–°æ¨¡å—çš„å¯¹è¯å¼ç»„ä»¶

**æ“ä½œï¼š**
```bash
# å¤åˆ¶å‚è€ƒç»„ä»¶
cp components/xiaohongshu-writing-page.tsx components/[æ–°æ¨¡å—]-writing-page.tsx

# æ‰¹é‡æ›¿æ¢ç»„ä»¶åç§°
sed -i 's/XiaohongshuWritingPage/[æ–°æ¨¡å—]WritingPage/g' components/[æ–°æ¨¡å—]-writing-page.tsx
sed -i 's/xiaohongshu/[æ–°æ¨¡å—]/g' components/[æ–°æ¨¡å—]-writing-page.tsx
```

âš ï¸ **æ‰¹é‡æ›¿æ¢é£é™©è­¦å‘Šï¼š**

ä½¿ç”¨ `sed` æ‰¹é‡æ›¿æ¢è™½ç„¶å¿«é€Ÿï¼Œä½†**åªä¼šæ›¿æ¢æ–‡æœ¬å­—ç¬¦ä¸²**ï¼Œä¸ä¼šç†è§£ä»£ç é€»è¾‘ï¼

**å…³é”®é—®é¢˜ï¼š** æ¨¡æ¿IDæ•°ç»„çš„å…·ä½“å€¼ä¸ä¼šè¢«æ›¿æ¢ï¼

ä¾‹å¦‚ï¼š
```typescript
// âŒ æ‰¹é‡æ›¿æ¢åä»ç„¶æ˜¯é”™è¯¯çš„
const reportTemplateIds = ["1001", "1002", ..., "1013"];  // è¿™æ˜¯æ²Ÿé€šåä½œçš„IDï¼

// âœ… éœ€è¦æ‰‹åŠ¨æ”¹ä¸º
const reportTemplateIds = ["1101", "1102", ..., "1112"];  // æ±‡æŠ¥æ€»ç»“çš„ID
```

**å¿…é¡»æ‰‹åŠ¨æ£€æŸ¥çš„3ä¸ªå…³é”®ä½ç½®ï¼š**

1. **åˆå§‹åŒ–æ¬¢è¿æ¶ˆæ¯çš„ useEffect**ï¼ˆçº¦ç¬¬595è¡Œï¼‰
   ```typescript
   useEffect(() => {
     const reportTemplateIds = ["1101", "1102", ..., "1112"];  // âš ï¸ æ£€æŸ¥è¿™é‡Œï¼
     if (reportTemplateIds.includes(templateId)) {
       // ...
     }
   }, [templateId]);
   ```

2. **æ–°å»ºå¯¹è¯å‡½æ•°**ï¼ˆçº¦ç¬¬850è¡Œï¼‰
   ```typescript
   const handleNewConversation = () => {
     const reportTemplateIds = ["1101", "1102", ..., "1112"];  // âš ï¸ æ£€æŸ¥è¿™é‡Œï¼
     if (reportTemplateIds.includes(templateId)) {
       // ...
     }
   };
   ```

3. **ä¸»æ¸²æŸ“é€»è¾‘çš„æ¡ä»¶åˆ¤æ–­**ï¼ˆçº¦ç¬¬870è¡Œï¼‰
   ```typescript
   return (
     <div>
       {["1101", "1102", ..., "1112"].includes(templateId) ? (  // âš ï¸ æ£€æŸ¥è¿™é‡Œï¼
         // å¯¹è¯å¼UI
       ) : (
         // ä¼ ç»Ÿè¡¨å•UI
       )}
     </div>
   );
   ```

**éªŒè¯æ–¹æ³•ï¼š**
```bash
# æœç´¢æ‰€æœ‰æ¨¡æ¿IDæ•°ç»„
grep -n "1001.*1013\|101.*108" components/[æ–°æ¨¡å—]-writing-page.tsx

# å¦‚æœæœ‰è¾“å‡ºï¼Œè¯´æ˜è¿˜æœ‰æ—§çš„æ¨¡æ¿IDéœ€è¦ä¿®æ”¹ï¼
```

**å…³é”®ä¿®æ”¹ç‚¹ï¼š**

#### 2.1 æ›´æ–°æ¨¡æ¿IDèŒƒå›´
```typescript
// ç¤ºä¾‹ï¼šæ±‡æŠ¥æ€»ç»“æ¨¡å— (1101-1112)
const reportTemplateIds = ["1101", "1102", "1103", "1104", "1105", "1106",
                           "1107", "1108", "1109", "1110", "1111", "1112"];

if (reportTemplateIds.includes(templateId)) {
  // å¯¹è¯å¼UIé€»è¾‘
}
```

#### 2.2 é…ç½®æ¬¢è¿æ¶ˆæ¯
```typescript
const getWelcomeMessage = (templateId: string): string => {
  const welcomeMessages: Record<string, string> = {
    "1101": `æ‚¨å¥½ï¼æˆ‘æ˜¯å·¥ä½œæ€»ç»“å¤§å¸ˆï¼Œæ‹¥æœ‰50å¹´é¡¹ç›®ç®¡ç†ç»éªŒã€‚

æˆ‘å¯ä»¥å¸®æ‚¨ï¼š
- å¿«é€Ÿæ¢³ç†å·¥ä½œå†…å®¹ï¼Œå»ºç«‹æ¸…æ™°çš„æ€»ç»“æ¡†æ¶
- æç‚¼å·¥ä½œäº®ç‚¹å’Œæ ¸å¿ƒæˆæœ
- æä¾›æ•°æ®åˆ†æå’Œå¯è§†åŒ–å»ºè®®

è¯·å‘Šè¯‰æˆ‘ï¼š
- æ‚¨éœ€è¦æ’°å†™ä»€ä¹ˆç±»å‹çš„å·¥ä½œæ€»ç»“ï¼Ÿï¼ˆå‘¨æŠ¥/æœˆæŠ¥/å­£åº¦/å¹´åº¦ï¼‰
- æ‚¨æ‰€åœ¨çš„è¡Œä¸šå’Œå²—ä½æ˜¯ä»€ä¹ˆï¼Ÿ
- è¿™ä»½æ€»ç»“ä¸»è¦æ±‡æŠ¥ç»™è°ï¼Ÿ`,

    "1102": `æ‚¨å¥½ï¼æˆ‘æ˜¯å·¥ä½œè®¡åˆ’å¤§å¸ˆ...`,
    // ... å…¶ä»–æ¨¡æ¿çš„æ¬¢è¿æ¶ˆæ¯
  };
  return welcomeMessages[templateId] || welcomeMessages["1101"];
};
```

**æ¬¢è¿æ¶ˆæ¯ç¼–å†™è§„èŒƒï¼š**
- âŒ ç¦æ­¢ä½¿ç”¨emojiè¡¨æƒ…ç¬¦å·
- âŒ ç¦æ­¢ä½¿ç”¨markdownæ ¼å¼æ ‡è®°ï¼ˆ**ã€###ã€---ç­‰ï¼‰
- âœ… ä½¿ç”¨çº¯æ–‡æœ¬æ ¼å¼
- âœ… ä½¿ç”¨æ•°å­—åˆ—è¡¨ï¼ˆ1. 2. 3.ï¼‰
- âœ… ä½¿ç”¨çŸ­æ¨ªçº¿ï¼ˆ-ï¼‰è¡¨ç¤ºåˆ—è¡¨é¡¹
- âœ… æ¸…æ™°è¯´æ˜è§’è‰²å®šä½å’Œèƒ½åŠ›
- âœ… å¼•å¯¼ç”¨æˆ·æä¾›å¿…è¦ä¿¡æ¯

#### 2.3 é…ç½®APIç«¯ç‚¹æ˜ å°„
```typescript
const getApiEndpoint = (templateId: string): string => {
  switch (templateId) {
    case "1101": return "/api/report/work-summary";
    case "1102": return "/api/report/work-plan";
    case "1103": return "/api/report/project-progress";
    // ... å…¶ä»–ç«¯ç‚¹
    default: return "/api/report/work-summary";
  }
};
```

#### 2.4 æ›´æ–°æ–°å»ºå¯¹è¯å‡½æ•°
```typescript
const handleNewConversation = () => {
  setConversationHistory([]);
  setCurrentResult("");
  setError("");
  setCurrentConversationId(null);
  setInputValue("");

  const templateIds = ["1101", "1102", ..., "1112"];
  if (templateIds.includes(templateId)) {
    setMessages([{
      id: 'welcome-' + Date.now(),
      role: 'assistant',
      content: getWelcomeMessage(templateId),
      isCollapsed: false
    }]);
    setInputHeight(60);
    if (inputRef.current) {
      inputRef.current.style.height = '60px';
    }
  }
};
```

---

### ç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºè·¯ç”±é…ç½®

**ç›®æ ‡ï¼š** ä¸ºæ–°æ¨¡å—åˆ›å»ºä¸“ç”¨è·¯ç”±

**æ“ä½œï¼š**
```bash
# åˆ›å»ºè·¯ç”±ç›®å½•
mkdir -p app/writing/[æ–°æ¨¡å—]

# åˆ›å»ºè·¯ç”±æ–‡ä»¶
touch app/writing/[æ–°æ¨¡å—]/page.tsx
```

**æ–‡ä»¶å†…å®¹ï¼š**
```typescript
import { Suspense } from "react";
import { AppLayout } from "@/components/app-layout";
import { [æ–°æ¨¡å—]WritingPage } from "@/components/[æ–°æ¨¡å—]-writing-page";

export default function [æ–°æ¨¡å—]Page() {
  return (
    <AppLayout>
      <Suspense fallback={<div className="flex items-center justify-center h-screen">åŠ è½½ä¸­...</div>}>
        <[æ–°æ¨¡å—]WritingPage />
      </Suspense>
    </AppLayout>
  );
}
```

---

### ç¬¬å››æ­¥ï¼šæ·»åŠ è‡ªåŠ¨é‡å®šå‘

**ç›®æ ‡ï¼š** è®©ç”¨æˆ·è®¿é—®é€šç”¨é¡µé¢æ—¶è‡ªåŠ¨è·³è½¬åˆ°å¯¹è¯å¼ç•Œé¢

**æ“ä½œï¼š**
ä¿®æ”¹ `components/general-writing-detail-page.tsx`

**æ·»åŠ é‡å®šå‘é€»è¾‘ï¼š**
```typescript
export function GeneralWritingDetailPage() {
  const router = useRouter();
  const searchParams = useSearchParams();
  const templateId = searchParams.get("template") || "1001";
  const templateTitle = searchParams.get("title") || "é€šç”¨å†™ä½œ";

  // æ£€æµ‹æ¨¡æ¿IDèŒƒå›´ï¼Œè‡ªåŠ¨é‡å®šå‘åˆ°å¯¹è¯å¼ç•Œé¢
  useEffect(() => {
    const numId = parseInt(templateId);

    // æ±‡æŠ¥æ€»ç»“æ¨¡å— (1101-1112)
    if (numId >= 1101 && numId <= 1112) {
      const source = searchParams.get("source") || "general";
      router.replace(`/writing/report?template=${templateId}&title=${encodeURIComponent(templateTitle)}&source=${source}`);
    }

    // æ²Ÿé€šåä½œæ¨¡å— (1001-1013)
    if (numId >= 1001 && numId <= 1013) {
      const source = searchParams.get("source") || "general";
      router.replace(`/writing/communication?template=${templateId}&title=${encodeURIComponent(templateTitle)}&source=${source}`);
    }
  }, [templateId, templateTitle, router, searchParams]);

  // ... å…¶ä½™ä»£ç 
}
```

---

### ç¬¬äº”æ­¥ï¼šæ•°æ®åº“å’Œç±»å‹é…ç½®

#### 5.1 æ›´æ–°æ•°æ®åº“è¡¨ç»“æ„

**æ–‡ä»¶ï¼š** `supabase/migrations/[timestamp]_add_[module]_types.sql`

```sql
-- æ·»åŠ æ–°çš„å¯¹è¯ç±»å‹åˆ°conversationsè¡¨çš„CHECKçº¦æŸ
ALTER TABLE conversations
DROP CONSTRAINT IF EXISTS conversations_type_check;

ALTER TABLE conversations
ADD CONSTRAINT conversations_type_check
CHECK (type IN (
  'qa', 'role',
  -- å°çº¢ä¹¦ç±»å‹
  'xiaohongshu-travel',
  'xiaohongshu-copywriting',
  -- ... å…¶ä»–å°çº¢ä¹¦ç±»å‹

  -- æ²Ÿé€šåä½œç±»å‹
  'communication-meeting-invitation',
  'communication-meeting-minutes',
  -- ... å…¶ä»–æ²Ÿé€šåä½œç±»å‹

  -- æ±‡æŠ¥æ€»ç»“ç±»å‹ï¼ˆæ–°å¢ï¼‰
  'report-work-summary',
  'report-work-plan',
  'report-project-progress',
  'report-sales-performance',
  'report-financial',
  'report-market-analysis',
  'report-annual-review',
  'report-probation-review',
  'report-performance-evaluation',
  'report-performance-improvement',
  'report-department-brief',
  'report-business-development'
));
```

#### 5.2 æ›´æ–°å¯¹è¯ç±»å‹æ˜ å°„

**æ–‡ä»¶ï¼š** `lib/conversations.ts`

```typescript
// æ·»åŠ æ–°æ¨¡å—çš„ç±»å‹å®šä¹‰
export type ReportType =
  | 'report-work-summary'           // 1101
  | 'report-work-plan'              // 1102
  | 'report-project-progress'       // 1103
  | 'report-sales-performance'      // 1104
  | 'report-financial'              // 1105
  | 'report-market-analysis'        // 1106
  | 'report-annual-review'          // 1107
  | 'report-probation-review'       // 1108
  | 'report-performance-evaluation' // 1109
  | 'report-performance-improvement'// 1110
  | 'report-department-brief'       // 1111
  | 'report-business-development';  // 1112

// æ›´æ–°ConversationTypeè”åˆç±»å‹
export type ConversationType =
  | 'qa'
  | 'role'
  | XiaohongshuType
  | CommunicationType
  | ReportType;  // æ–°å¢

// æ·»åŠ æ¨¡æ¿IDåˆ°å¯¹è¯ç±»å‹çš„æ˜ å°„å‡½æ•°
export function getReportTypeByTemplateId(templateId: string): ReportType {
  const mapping: Record<string, ReportType> = {
    '1101': 'report-work-summary',
    '1102': 'report-work-plan',
    '1103': 'report-project-progress',
    '1104': 'report-sales-performance',
    '1105': 'report-financial',
    '1106': 'report-market-analysis',
    '1107': 'report-annual-review',
    '1108': 'report-probation-review',
    '1109': 'report-performance-evaluation',
    '1110': 'report-performance-improvement',
    '1111': 'report-department-brief',
    '1112': 'report-business-development',
  };
  return mapping[templateId] || 'report-work-summary';
}
```

---

## ğŸ”§ APIç«¯ç‚¹å¼€å‘

### æ ‡å‡†APIç«¯ç‚¹ç»“æ„

**æ–‡ä»¶ä½ç½®ï¼š** `app/api/[module]/[subtype]/route.ts`

**ç¤ºä¾‹ï¼š** `app/api/report/work-summary/route.ts`

```typescript
import { NextRequest, NextResponse } from "next/server";

// ç³»ç»Ÿæç¤ºè¯ï¼ˆä»docs/report-prompts/1101-å‘¨æœˆå­£åº¦å·¥ä½œæ€»ç»“.mdè·å–ï¼‰
const SYSTEM_PROMPT = `
# å·¥ä½œæ€»ç»“å¤§å¸ˆ Prompt

## è§’è‰² (Role)
å·¥ä½œæ€»ç»“å¤§å¸ˆ - æ‹¥æœ‰50å¹´é¡¹ç›®ç®¡ç†ä¸æ€»ç»“æ’°å†™ç»éªŒçš„ä¸“ä¸šé¡¾é—®

... ï¼ˆå®Œæ•´çš„ç³»ç»Ÿæç¤ºè¯å†…å®¹ï¼‰
`;

export async function POST(request: NextRequest) {
  try {
    const { messages } = await request.json();

    // æ„å»ºå®Œæ•´çš„æ¶ˆæ¯å†å²
    const fullMessages = [
      { role: "system", content: SYSTEM_PROMPT },
      ...messages
    ];

    // è°ƒç”¨AI API
    const response = await fetch("https://api.anthropic.com/v1/messages", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "x-api-key": process.env.ANTHROPIC_API_KEY || "",
        "anthropic-version": "2023-06-01",
      },
      body: JSON.stringify({
        model: "claude-3-5-sonnet-20241022",
        max_tokens: 4096,
        messages: fullMessages,
      }),
    });

    const data = await response.json();
    const result = data.content[0].text;

    return NextResponse.json({ result });
  } catch (error) {
    console.error("API Error:", error);
    return NextResponse.json(
      { error: "ç”Ÿæˆå¤±è´¥ï¼Œè¯·é‡è¯•" },
      { status: 500 }
    );
  }
}
```

---

## âœ… æµ‹è¯•æ¸…å•

### åŠŸèƒ½æµ‹è¯•
- [ ] è®¿é—® `/writing/general?template=[ID]` èƒ½å¦è‡ªåŠ¨é‡å®šå‘
- [ ] å¯¹è¯å¼ç•Œé¢æ˜¯å¦æ­£å¸¸æ˜¾ç¤º
- [ ] æ¬¢è¿æ¶ˆæ¯æ˜¯å¦æ­£ç¡®æ˜¾ç¤ºï¼ˆæ— emojiã€æ— markdownï¼‰
- [ ] è¾“å…¥æ¡†æ˜¯å¦æ”¯æŒEnterå‘é€ã€Shift+Enteræ¢è¡Œ
- [ ] è¾“å…¥æ¡†é«˜åº¦æ˜¯å¦è‡ªé€‚åº”ï¼ˆ60px-150pxï¼‰
- [ ] å¤šè½®å¯¹è¯æ˜¯å¦æ­£å¸¸å·¥ä½œï¼ˆæœ€å¤š5è½®ï¼‰
- [ ] å¯¹è¯è½®æ¬¡æ˜¾ç¤ºæ˜¯å¦æ­£ç¡®
- [ ] æ–°å»ºå¯¹è¯åŠŸèƒ½æ˜¯å¦æ­£å¸¸
- [ ] å†å²è®°å½•åŠŸèƒ½æ˜¯å¦æ­£å¸¸
- [ ] å¯Œæ–‡æœ¬ç¼–è¾‘å™¨æ˜¯å¦æ­£å¸¸æ˜¾ç¤ºç»“æœ
- [ ] å¤åˆ¶åŠŸèƒ½æ˜¯å¦æ­£å¸¸
- [ ] è¿”å›æŒ‰é’®æ˜¯å¦æ­£å¸¸

### æ•°æ®æµ‹è¯•
- [ ] å¯¹è¯å†å²æ˜¯å¦æ­£ç¡®ä¿å­˜åˆ°æ•°æ®åº“
- [ ] å¯¹è¯ç±»å‹æ˜¯å¦æ­£ç¡®æ˜ å°„
- [ ] å†å²è®°å½•æ˜¯å¦èƒ½æ­£ç¡®åŠ è½½
- [ ] å†å²è®°å½•æ˜¯å¦èƒ½æ­£ç¡®æ¢å¤å¯¹è¯

---

## ğŸ“Š å¼€å‘è¿›åº¦è·Ÿè¸ªæ¨¡æ¿

```markdown
## [æ¨¡å—åç§°] å¯¹è¯å¼UIå¼€å‘è¿›åº¦

### ç¬¬ä¸€æ­¥ï¼šåˆ†æå‚è€ƒæ¨¡æ¿ âœ…
- [x] é˜…è¯»xiaohongshu-writing-page.tsx
- [x] ç†è§£å¯¹è¯å¼UIå®ç°é€»è¾‘

### ç¬¬äºŒæ­¥ï¼šåˆ›å»ºæ–°ç»„ä»¶ â³
- [ ] å¤åˆ¶å‚è€ƒç»„ä»¶
- [ ] æ›´æ–°æ¨¡æ¿IDèŒƒå›´
- [ ] é…ç½®æ¬¢è¿æ¶ˆæ¯ï¼ˆ12ä¸ªå­ç±»å‹ï¼‰
- [ ] é…ç½®APIç«¯ç‚¹æ˜ å°„
- [ ] æ›´æ–°æ–°å»ºå¯¹è¯å‡½æ•°

### ç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºè·¯ç”±é…ç½® â³
- [ ] åˆ›å»ºè·¯ç”±ç›®å½•
- [ ] åˆ›å»ºè·¯ç”±æ–‡ä»¶

### ç¬¬å››æ­¥ï¼šæ·»åŠ è‡ªåŠ¨é‡å®šå‘ â³
- [ ] ä¿®æ”¹general-writing-detail-page.tsx
- [ ] æ·»åŠ é‡å®šå‘é€»è¾‘

### ç¬¬äº”æ­¥ï¼šæ•°æ®åº“å’Œç±»å‹é…ç½® â³
- [ ] æ›´æ–°æ•°æ®åº“è¡¨ç»“æ„
- [ ] æ›´æ–°å¯¹è¯ç±»å‹æ˜ å°„
- [ ] åˆ›å»º12ä¸ªAPIç«¯ç‚¹æ–‡ä»¶

### æµ‹è¯•å’Œéƒ¨ç½² â³
- [ ] åŠŸèƒ½æµ‹è¯•
- [ ] æ•°æ®æµ‹è¯•
- [ ] æäº¤ä»£ç 
- [ ] æ¨é€åˆ°è¿œç¨‹ä»“åº“
```

---

## ğŸ“š å‚è€ƒæ–‡æ¡£

- [å°çº¢ä¹¦æ¨¡å—å¼€å‘è§„èŒƒ](./å°çº¢ä¹¦æ¨¡å—å¼€å‘è§„èŒƒ.md) - æ ¼å¼è§„èŒƒ
- [ä¼šè®®é‚€è¯·å‡½å¯¹è¯å¼UIå®ç°](./communication-dialog-ui-implementation.md) - å®é™…æ¡ˆä¾‹
- [å¯¹è¯å†å²å’ŒUIè®¾è®¡](./conversation-history-and-ui-design.md) - è®¾è®¡æ–‡æ¡£

---

## ğŸ› å¸¸è§é—®é¢˜ä¸æ•…éšœæ’æŸ¥

### Q1: ä¸ºä»€ä¹ˆè¦ç¦æ­¢emojiå’Œmarkdownï¼Ÿ
**A:** å¯¹è¯æ¡†ä¸­çš„å†…å®¹éœ€è¦ä¿æŒçº¯æ–‡æœ¬æ ¼å¼ï¼Œä»¥ç¡®ä¿ï¼š
1. åœ¨ä¸åŒè®¾å¤‡å’Œæµè§ˆå™¨ä¸Šæ˜¾ç¤ºä¸€è‡´
2. ä¾¿äºç”¨æˆ·å¤åˆ¶å’Œç¼–è¾‘
3. é¿å…æ ¼å¼è§£æé—®é¢˜

### Q2: å¯¹è¯è½®æ¬¡é™åˆ¶æ˜¯å¤šå°‘ï¼Ÿ
**A:** æœ€å¤šæ”¯æŒ5è½®å¯¹è¯ï¼ˆ10æ¡æ¶ˆæ¯ï¼š5æ¡ç”¨æˆ·æ¶ˆæ¯ + 5æ¡AIå›å¤ï¼‰ã€‚è¾¾åˆ°é™åˆ¶åï¼Œç”¨æˆ·éœ€è¦ç‚¹å‡»"æ–°å»ºå¯¹è¯"å¼€å§‹æ–°çš„åˆ›ä½œã€‚

### Q3: å¦‚ä½•å¿«é€Ÿåˆ›å»ºæ–°æ¨¡å—ï¼Ÿ
**A:** æŒ‰ç…§æœ¬æ–‡æ¡£çš„5æ­¥æ³•ï¼Œä»å¤åˆ¶å‚è€ƒç»„ä»¶å¼€å§‹ï¼Œé€æ­¥ä¿®æ”¹é…ç½®å³å¯ã€‚å…³é”®æ˜¯ç¡®ä¿ï¼š
- æ¨¡æ¿IDèŒƒå›´æ­£ç¡®
- æ¬¢è¿æ¶ˆæ¯ç¬¦åˆè§„èŒƒ
- APIç«¯ç‚¹æ˜ å°„å®Œæ•´
- æ•°æ®åº“ç±»å‹å·²æ·»åŠ 

### Q4: âš ï¸ è®¿é—®æ¨¡å—æ—¶æ˜¾ç¤ºä¼ ç»Ÿè¡¨å•è€Œéå¯¹è¯å¼UIï¼Ÿ

**é—®é¢˜ç°è±¡ï¼š**
- è®¿é—® `/writing/general?template=1101` æ—¶æ˜¾ç¤ºä¼ ç»Ÿè¡¨å•ç•Œé¢
- åº”è¯¥æ˜¾ç¤ºå¯¹è¯å¼UIä½†æ²¡æœ‰è‡ªåŠ¨è·³è½¬
- Verceléƒ¨ç½²æˆåŠŸä½†åŠŸèƒ½ä¸æ­£å¸¸

**é—®é¢˜åŸå› ï¼š**
ç¼ºå°‘å…³é”®é…ç½®å¯¼è‡´é‡å®šå‘é€»è¾‘æœªç”Ÿæ•ˆï¼š
1. âŒ ç¼ºå°‘æ¨¡å—ä¸“ç”¨è·¯ç”±æ–‡ä»¶ï¼ˆå¦‚ `app/writing/report/page.tsx`ï¼‰
2. âŒ ç¼ºå°‘è‡ªåŠ¨é‡å®šå‘é€»è¾‘ï¼ˆåœ¨ `general-writing-detail-page.tsx` ä¸­ï¼‰

**è§£å†³æ–¹æ¡ˆï¼š**

#### æ­¥éª¤1ï¼šåˆ›å»ºè·¯ç”±æ–‡ä»¶
```bash
# åˆ›å»ºè·¯ç”±ç›®å½•
mkdir -p app/writing/[æ¨¡å—å]

# åˆ›å»ºè·¯ç”±æ–‡ä»¶
touch app/writing/[æ¨¡å—å]/page.tsx
```

**è·¯ç”±æ–‡ä»¶å†…å®¹ï¼š**
```typescript
import { Suspense } from "react";
import { AppLayout } from "@/components/app-layout";
import { [æ¨¡å—å]WritingPage } from "@/components/[æ¨¡å—å]-writing-page";

export default function [æ¨¡å—å]Page() {
  return (
    <AppLayout>
      <Suspense fallback={<div className="flex items-center justify-center h-screen">åŠ è½½ä¸­...</div>}>
        <[æ¨¡å—å]WritingPage />
      </Suspense>
    </AppLayout>
  );
}
```

#### æ­¥éª¤2ï¼šæ·»åŠ é‡å®šå‘é€»è¾‘

**æ–‡ä»¶ï¼š** `components/general-writing-detail-page.tsx`

åœ¨ `useEffect` ä¸­æ·»åŠ æ¨¡æ¿IDèŒƒå›´æ£€æµ‹ï¼š

```typescript
export function GeneralWritingDetailPage() {
  const router = useRouter();
  const searchParams = useSearchParams();
  const templateId = searchParams.get("template") || "1001";
  const templateTitle = searchParams.get("title") || "é€šç”¨å†™ä½œ";

  // æ£€æµ‹æ¨¡æ¿IDèŒƒå›´ï¼Œè‡ªåŠ¨é‡å®šå‘åˆ°å¯¹è¯å¼ç•Œé¢
  useEffect(() => {
    const numId = parseInt(templateId);

    // æ²Ÿé€šåä½œæ¨¡å— (1001-1013)
    if (numId >= 1001 && numId <= 1013) {
      const source = searchParams.get("source") || "general";
      router.replace(`/writing/communication?template=${templateId}&title=${encodeURIComponent(templateTitle)}&source=${source}`);
    }

    // æ±‡æŠ¥æ€»ç»“æ¨¡å— (1101-1112) - æ–°å¢
    if (numId >= 1101 && numId <= 1112) {
      const source = searchParams.get("source") || "general";
      router.replace(`/writing/report?template=${templateId}&title=${encodeURIComponent(templateTitle)}&source=${source}`);
    }

    // å…¶ä»–æ¨¡å—æŒ‰éœ€æ·»åŠ ...
  }, [templateId, templateTitle, router, searchParams]);

  // ... å…¶ä½™ä»£ç 
}
```

#### æ­¥éª¤3ï¼šéªŒè¯ä¿®å¤

**æµ‹è¯•æ¸…å•ï¼š**
- [ ] è®¿é—® `/writing/general?template=[ID]` èƒ½å¦è‡ªåŠ¨é‡å®šå‘
- [ ] é‡å®šå‘åçš„URLæ˜¯å¦æ­£ç¡®ï¼ˆ`/writing/[æ¨¡å—]?template=[ID]&title=...`ï¼‰
- [ ] å¯¹è¯å¼UIç•Œé¢æ˜¯å¦æ­£å¸¸æ˜¾ç¤º
- [ ] æ¬¢è¿æ¶ˆæ¯æ˜¯å¦æ­£ç¡®æ˜¾ç¤º

#### æ­¥éª¤4ï¼šæäº¤éƒ¨ç½²

```bash
# æ·»åŠ æ–‡ä»¶
git add app/writing/[æ¨¡å—]/ components/general-writing-detail-page.tsx

# æäº¤
git commit -m "fix([æ¨¡å—]): æ·»åŠ è·¯ç”±å’Œè‡ªåŠ¨é‡å®šå‘é€»è¾‘"

# æ¨é€
git push
```

**ç­‰å¾…Vercelè‡ªåŠ¨éƒ¨ç½²ï¼ˆçº¦1-2åˆ†é’Ÿï¼‰ï¼Œç„¶ååˆ·æ–°é¡µé¢éªŒè¯ã€‚**

**é‡è¦æç¤ºï¼š**
- âš ï¸ å¿…é¡»åŒæ—¶å®Œæˆè·¯ç”±åˆ›å»ºå’Œé‡å®šå‘é…ç½®ï¼Œç¼ºä¸€ä¸å¯
- âš ï¸ æ¨¡æ¿IDèŒƒå›´å¿…é¡»å‡†ç¡®åŒ¹é…ï¼ˆå¦‚1101-1112ï¼‰
- âš ï¸ é‡å®šå‘è·¯å¾„å¿…é¡»ä¸è·¯ç”±æ–‡ä»¶ä½ç½®ä¸€è‡´
- âš ï¸ è®°å¾—ä¿æŒURLå‚æ•°çš„å®Œæ•´ä¼ é€’ï¼ˆtemplateã€titleã€sourceï¼‰

---

### Q5: âš ï¸ æ‰¹é‡æ›¿æ¢åä»æ˜¾ç¤ºä¼ ç»Ÿè¡¨å•ç•Œé¢ï¼Ÿ

**é—®é¢˜ç°è±¡ï¼š**
- å·²ç»å¤åˆ¶ç»„ä»¶å¹¶ä½¿ç”¨ `sed` æ‰¹é‡æ›¿æ¢
- è·¯ç”±å’Œé‡å®šå‘éƒ½é…ç½®æ­£ç¡®
- Verceléƒ¨ç½²æˆåŠŸï¼Œæ— é”™è¯¯
- ä½†è®¿é—®é¡µé¢æ—¶ä»ç„¶æ˜¾ç¤ºä¼ ç»Ÿè¡¨å•ç•Œé¢ï¼Œè€Œä¸æ˜¯å¯¹è¯å¼UI

**é—®é¢˜æ ¹æœ¬åŸå› ï¼š**

`sed` æ‰¹é‡æ›¿æ¢**åªæ›¿æ¢æ–‡æœ¬å­—ç¬¦ä¸²**ï¼Œä¸ç†è§£ä»£ç é€»è¾‘ï¼

**å…·ä½“é—®é¢˜ï¼š** æ¨¡æ¿IDæ•°ç»„ä¸­çš„å…·ä½“æ•°å€¼æ²¡æœ‰è¢«æ›¿æ¢

```typescript
// å¤åˆ¶è‡ª communication-writing-page.tsx å
const reportTemplateIds = ["1001", "1002", ..., "1013"];  // âŒ ä»ç„¶æ˜¯æ²Ÿé€šåä½œçš„ID

// æ¡ä»¶åˆ¤æ–­æ°¸è¿œä¸º false
if (reportTemplateIds.includes("1101")) {  // falseï¼
  // å¯¹è¯å¼UIï¼ˆæ°¸è¿œä¸ä¼šæ‰§è¡Œï¼‰
} else {
  // ä¼ ç»Ÿè¡¨å•UIï¼ˆæ€»æ˜¯æ‰§è¡Œè¿™é‡Œï¼‰
}
```

**è§£å†³æ–¹æ¡ˆï¼š**

#### æ­¥éª¤1ï¼šæœç´¢æ—§çš„æ¨¡æ¿ID
```bash
# æœç´¢æ‰€æœ‰å¯èƒ½çš„æ—§æ¨¡æ¿ID
grep -n "1001.*1013\|101.*108" components/[æ–°æ¨¡å—]-writing-page.tsx

# ç¤ºä¾‹è¾“å‡ºï¼š
# 596:    const reportTemplateIds = ["1001", "1002", ..., "1013"];
# 853:    const reportTemplateIds = ["1001", "1002", ..., "1013"];
# 871:      {["101", "102", ..., "1013"].includes(templateId) ? (
```

#### æ­¥éª¤2ï¼šæ‰‹åŠ¨ä¿®æ”¹3ä¸ªå…³é”®ä½ç½®

**ä½ç½®1ï¼šåˆå§‹åŒ–æ¬¢è¿æ¶ˆæ¯ï¼ˆçº¦ç¬¬595è¡Œï¼‰**
```typescript
// âŒ é”™è¯¯
const reportTemplateIds = ["1001", "1002", "1003", "1004", "1005", "1006",
                           "1007", "1008", "1009", "1010", "1011", "1012", "1013"];

// âœ… æ­£ç¡®ï¼ˆæ±‡æŠ¥æ€»ç»“æ¨¡å—ç¤ºä¾‹ï¼‰
const reportTemplateIds = ["1101", "1102", "1103", "1104", "1105", "1106",
                           "1107", "1108", "1109", "1110", "1111", "1112"];
```

**ä½ç½®2ï¼šæ–°å»ºå¯¹è¯å‡½æ•°ï¼ˆçº¦ç¬¬850è¡Œï¼‰**
```typescript
// âŒ é”™è¯¯
const reportTemplateIds = ["1001", "1002", ..., "1013"];

// âœ… æ­£ç¡®
const reportTemplateIds = ["1101", "1102", ..., "1112"];
```

**ä½ç½®3ï¼šä¸»æ¸²æŸ“é€»è¾‘ï¼ˆçº¦ç¬¬870è¡Œï¼‰**
```typescript
// âŒ é”™è¯¯
{["101", "102", ..., "1001", "1002", ..., "1013"].includes(templateId) ? (

// âœ… æ­£ç¡®
{["1101", "1102", "1103", "1104", "1105", "1106",
  "1107", "1108", "1109", "1110", "1111", "1112"].includes(templateId) ? (
```

#### æ­¥éª¤3ï¼šéªŒè¯ä¿®å¤

```bash
# å†æ¬¡æœç´¢ï¼Œç¡®ä¿æ²¡æœ‰æ—§ID
grep -n "1001.*1013\|101.*108" components/[æ–°æ¨¡å—]-writing-page.tsx

# åº”è¯¥æ²¡æœ‰è¾“å‡ºï¼Œæˆ–è€…åªåœ¨æ³¨é‡Šä¸­å‡ºç°
```

#### æ­¥éª¤4ï¼šæµ‹è¯•éªŒè¯

**æµ‹è¯•æ¸…å•ï¼š**
- [ ] è®¿é—® `/writing/[æ¨¡å—]?template=[æ–°æ¨¡å—çš„ç¬¬ä¸€ä¸ªID]`
- [ ] æ£€æŸ¥æ˜¯å¦æ˜¾ç¤ºå¯¹è¯å¼UIï¼ˆå·¦ä¾§å¯¹è¯åŒºï¼Œå³ä¾§ç¼–è¾‘å™¨ï¼‰
- [ ] æ£€æŸ¥æ˜¯å¦æ˜¾ç¤ºæ¬¢è¿æ¶ˆæ¯
- [ ] æ£€æŸ¥è¾“å…¥æ¡†æ˜¯å¦å¯ç”¨
- [ ] æ£€æŸ¥"æ–°å»ºå¯¹è¯"å’Œ"å†å²è®°å½•"æŒ‰é’®æ˜¯å¦æ˜¾ç¤º

**é¢„é˜²æªæ–½ï¼š**

1. **åˆ›å»ºæ£€æŸ¥è„šæœ¬**
   ```bash
   # ä¿å­˜ä¸º check-template-ids.sh
   #!/bin/bash
   MODULE_FILE=$1
   echo "æ£€æŸ¥æ¨¡æ¿IDé…ç½®..."

   # æœç´¢å¯èƒ½çš„æ—§ID
   OLD_IDS=$(grep -n "1001.*1013\|101.*108" "$MODULE_FILE" | grep -v "^[[:space:]]*//")

   if [ -n "$OLD_IDS" ]; then
     echo "âš ï¸ å‘ç°æ—§çš„æ¨¡æ¿IDï¼Œéœ€è¦æ‰‹åŠ¨ä¿®æ”¹ï¼š"
     echo "$OLD_IDS"
     exit 1
   else
     echo "âœ… æ¨¡æ¿IDé…ç½®æ­£ç¡®"
     exit 0
   fi
   ```

2. **åœ¨æäº¤å‰è¿è¡Œæ£€æŸ¥**
   ```bash
   bash check-template-ids.sh components/report-writing-page.tsx
   ```

3. **æ·»åŠ åˆ°å¼€å‘æµç¨‹**
   - åœ¨"ç¬¬äºŒæ­¥ï¼šåˆ›å»ºæ–°ç»„ä»¶"å®Œæˆåï¼Œç«‹å³è¿è¡Œæ£€æŸ¥è„šæœ¬
   - åœ¨æäº¤ä»£ç å‰ï¼Œå†æ¬¡è¿è¡Œæ£€æŸ¥è„šæœ¬

**é‡è¦æç¤ºï¼š**
- âš ï¸ è¿™æ˜¯æœ€å¸¸è§çš„é”™è¯¯ï¼Œå¿…é¡»ç‰¹åˆ«æ³¨æ„ï¼
- âš ï¸ æ‰¹é‡æ›¿æ¢åå¿…é¡»æ‰‹åŠ¨æ£€æŸ¥æ¨¡æ¿IDæ•°ç»„
- âš ï¸ å»ºè®®ä½¿ç”¨æ£€æŸ¥è„šæœ¬è‡ªåŠ¨åŒ–éªŒè¯
- âš ï¸ å¦‚æœä¸ç¡®å®šï¼Œå¯ä»¥ç›´æ¥æœç´¢æ–‡ä»¶ä¸­çš„æ‰€æœ‰æ•°å­—æ•°ç»„

---

**æ–‡æ¡£ç‰ˆæœ¬ï¼š** v1.2
**æœ€åæ›´æ–°ï¼š** 2026-02-11
**ç»´æŠ¤è€…ï¼š** Claude Sonnet 4.5

**æ›´æ–°æ—¥å¿—ï¼š**
- v1.2 (2026-02-11): æ·»åŠ Q5å’Œæ‰¹é‡æ›¿æ¢é£é™©è­¦å‘Š - è§£å†³æ¨¡æ¿IDæœªæ­£ç¡®æ›¿æ¢é—®é¢˜
- v1.1 (2026-02-11): æ·»åŠ Q4æ•…éšœæ’æŸ¥ - è§£å†³ä¼ ç»Ÿè¡¨å•æ˜¾ç¤ºé—®é¢˜
- v1.0 (2026-02-11): åˆå§‹ç‰ˆæœ¬ï¼Œæ•´åˆå¯¹è¯å¼UIå¼€å‘æµç¨‹
